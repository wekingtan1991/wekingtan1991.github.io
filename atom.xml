<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>weking 的技术</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://yoursite.com/"/>
  <updated>2018-07-05T05:48:59.578Z</updated>
  <id>http://yoursite.com/</id>
  
  <author>
    <name>wekingtan</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>RecyclerView使用</title>
    <link href="http://yoursite.com/2018/07/05/RecyclerView%E4%BD%BF%E7%94%A8/"/>
    <id>http://yoursite.com/2018/07/05/RecyclerView使用/</id>
    <published>2018-07-05T05:48:59.000Z</published>
    <updated>2018-07-05T05:48:59.578Z</updated>
    
    <summary type="html">
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>Fragment 使用</title>
    <link href="http://yoursite.com/2018/07/05/Fragment%E4%BD%BF%E7%94%A8/"/>
    <id>http://yoursite.com/2018/07/05/Fragment使用/</id>
    <published>2018-07-05T05:48:36.000Z</published>
    <updated>2018-07-05T11:02:14.003Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Fragment-的-add、hide、show"><a href="#Fragment-的-add、hide、show" class="headerlink" title="Fragment 的 add、hide、show"></a>Fragment 的 add、hide、show</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">public class FragmentHelper &#123;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 添加 Fragment</span><br><span class="line">     * @param fragmentManager</span><br><span class="line">     * @param fragment</span><br><span class="line">     * @param fragmentTag</span><br><span class="line">     */</span><br><span class="line">    public static void addFragment(FragmentManager fragmentManager, Fragment fragment, String fragmentTag)&#123;</span><br><span class="line">        if (fragmentManager != null)&#123;</span><br><span class="line">            FragmentTransaction transaction = fragmentManager.beginTransaction();</span><br><span class="line">            transaction.add(R.id.frag_main, fragment, fragmentTag);</span><br><span class="line">            transaction.commit();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 显示已存在的 Fragment</span><br><span class="line">     * @param fragmentManager</span><br><span class="line">     * @param fragment</span><br><span class="line">     */</span><br><span class="line">    public static void showFragment(FragmentManager fragmentManager, Fragment fragment)&#123;</span><br><span class="line">        FragmentTransaction fragmentTransaction = fragmentManager.beginTransaction();</span><br><span class="line">        if (fragment != null)&#123;</span><br><span class="line">            fragmentTransaction.show(fragment);</span><br><span class="line">            fragmentTransaction.commit();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 隐藏所有的 Fragment</span><br><span class="line">     * @param fragmentManager</span><br><span class="line">     */</span><br><span class="line">    public static void hideAllFragment(FragmentManager fragmentManager)&#123;</span><br><span class="line">        FragmentTransaction fragmentTransaction = fragmentManager.beginTransaction();</span><br><span class="line"></span><br><span class="line">        Fragment dashboard_fragment = fragmentManager.findFragmentByTag(&quot;dashboard_fragment&quot;);</span><br><span class="line">        if (dashboard_fragment != null)&#123;</span><br><span class="line">            fragmentTransaction.hide(dashboard_fragment);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        fragmentTransaction.commit();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h1><ul><li><a href="https://www.jianshu.com/p/d9143a92ad94" target="_blank" rel="noopener">Fragment全解析系列</a></li><li><a href="https://www.jianshu.com/p/662c46cd3b5f" target="_blank" rel="noopener">Fragment你真的熟悉吗？看了才知道</a></li><li><a href="https://www.jianshu.com/p/28ca4cbe190c" target="_blank" rel="noopener">Android基础：Fragment，看这篇就够了</a></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;Fragment-的-add、hide、show&quot;&gt;&lt;a href=&quot;#Fragment-的-add、hide、show&quot; class=&quot;headerlink&quot; title=&quot;Fragment 的 add、hide、show&quot;&gt;&lt;/a&gt;Fragment 的 add
      
    
    </summary>
    
      <category term="Android" scheme="http://yoursite.com/categories/Android/"/>
    
    
      <category term="Android" scheme="http://yoursite.com/tags/Android/"/>
    
      <category term="Fragment" scheme="http://yoursite.com/tags/Fragment/"/>
    
  </entry>
  
  <entry>
    <title>自定义 View</title>
    <link href="http://yoursite.com/2018/07/05/%E8%87%AA%E5%AE%9A%E4%B9%89View/"/>
    <id>http://yoursite.com/2018/07/05/自定义View/</id>
    <published>2018-07-05T05:48:16.000Z</published>
    <updated>2018-07-05T11:03:06.347Z</updated>
    
    <content type="html"><![CDATA[<h1 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h1><ul><li><p><a href="http://www.gcssloop.com/customview/CustomViewIndex/" target="_blank" rel="noopener">安卓自定义View教程</a></p></li><li><p><a href="https://blog.csdn.net/ccy0122/article/details/53241648" target="_blank" rel="noopener">仿支付宝芝麻信用的仪表盘</a></p></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;参考资料&quot;&gt;&lt;a href=&quot;#参考资料&quot; class=&quot;headerlink&quot; title=&quot;参考资料&quot;&gt;&lt;/a&gt;参考资料&lt;/h1&gt;&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&quot;http://www.gcssloop.com/customview/CustomVie
      
    
    </summary>
    
      <category term="Android" scheme="http://yoursite.com/categories/Android/"/>
    
    
      <category term="Android" scheme="http://yoursite.com/tags/Android/"/>
    
      <category term="自定义 View" scheme="http://yoursite.com/tags/%E8%87%AA%E5%AE%9A%E4%B9%89-View/"/>
    
  </entry>
  
  <entry>
    <title>Intent使用</title>
    <link href="http://yoursite.com/2018/07/05/Intent%E4%BD%BF%E7%94%A8/"/>
    <id>http://yoursite.com/2018/07/05/Intent使用/</id>
    <published>2018-07-05T05:47:59.000Z</published>
    <updated>2018-07-05T05:47:59.177Z</updated>
    
    <summary type="html">
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>Service 使用</title>
    <link href="http://yoursite.com/2018/07/05/Service%E4%BD%BF%E7%94%A8/"/>
    <id>http://yoursite.com/2018/07/05/Service使用/</id>
    <published>2018-07-05T05:47:42.000Z</published>
    <updated>2018-07-06T04:22:20.156Z</updated>
    
    <content type="html"><![CDATA[<h1 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h1><blockquote><p><code>服务</code>是 Android 中实现程序后台运行的解决方案，它非常适合去执行那些<code>不需要和用户交互而还要求长期运行的任务</code>。</p></blockquote><p>服务的运行不依赖于任何用户界面，即使程序被切换到后台，或者用户打开了另外一个应用程序，服务仍然能够保持正常运行。但服务不是运行在一个独立的进程中，而是依赖于创建服务时所在的应用程序。当应用程序进程被杀死，服务也会被停止运行。</p><p>服务并不会自动开启线程，默认运行在主线程中。</p><h1 id="Android-多线程"><a href="#Android-多线程" class="headerlink" title="Android 多线程"></a>Android 多线程</h1><h2 id="线程基本用法"><a href="#线程基本用法" class="headerlink" title="线程基本用法"></a>线程基本用法</h2><p>1.继承的方式耦合性有点高<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyThread</span> <span class="keyword">extends</span> <span class="title">Thread</span></span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="comment">//处理具体的逻辑</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">new</span> MyThread().start();</span><br></pre></td></tr></table></figure></p><p>2.实现 Runnable 接口的方式<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyThread</span> <span class="keyword">implements</span> <span class="title">Runnable</span></span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="comment">//处理具体的逻辑</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">MyThread myThread = <span class="keyword">new</span> MyThread();</span><br><span class="line"><span class="keyword">new</span> Thread(myThread).start();</span><br></pre></td></tr></table></figure></p><p>3.<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> Thread(<span class="keyword">new</span> Runnable()&#123;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="comment">//处理具体的逻辑</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;).start();</span><br></pre></td></tr></table></figure></p><h2 id="在子线程中更新-UI"><a href="#在子线程中更新-UI" class="headerlink" title="在子线程中更新 UI"></a>在子线程中更新 UI</h2><p>Android 是不允许在子线程中更新 UI。但它提供了一套<code>异步消息处理机制</code>，可以解决在子线程中进行 UI 操作。</p><ul><li><p>首先在主线程创建一个 Handler，并重写 handleMessage() 方法：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">private Handler handler = new Handler()&#123;</span><br><span class="line"></span><br><span class="line">   public void handleMessage(Message msg)&#123;</span><br><span class="line">     switch (msg.what)&#123;</span><br><span class="line">       case 常量</span><br><span class="line">       //在这里进行 UI 操作</span><br><span class="line">       break;</span><br><span class="line">     &#125;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>在需要更新 UI 的子线程中创建一个 Message 对象：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Message message = new Message();</span><br><span class="line">message.what = 常量;</span><br><span class="line">handler.sendMessage(message); //将 Message 对象发送出去</span><br></pre></td></tr></table></figure></li></ul><h2 id="解析异步消息处理机制"><a href="#解析异步消息处理机制" class="headerlink" title="解析异步消息处理机制"></a>解析异步消息处理机制</h2><p>Android 的异步消息处理机制由 4 部分组成：Message、Handler、MessageQueue、Looper。</p><h3 id="Message"><a href="#Message" class="headerlink" title="Message"></a>Message</h3><p>Message 是在线程之间传递消息，可以在内部携带少量消息，用于在不同线程之间交换数据。<code>what</code> 字段携带 String 数据，<code>arg1</code>、<code>arg2</code> 字段携带整型数据，<code>obj</code> 字段携带一个 Object 对象。</p><h3 id="Handler"><a href="#Handler" class="headerlink" title="Handler"></a>Handler</h3><p>主要用于发送和处理消息。<br>发送消息一般用 Handler 的 <code>sendMessage()</code> 方法。<br>接收消息 Handler 的 <code>handleMessage()</code> 方法。</p><h3 id="MessageQueue"><a href="#MessageQueue" class="headerlink" title="MessageQueue"></a>MessageQueue</h3><p>MessageQueue 是消息队列，主要用于存放所有通过 Handler 发送的消息。<code>每个线程只会有一个 MessageQueue 对象</code>。</p><h3 id="Looper"><a href="#Looper" class="headerlink" title="Looper"></a>Looper</h3><p>Looper 是每个线程中的 MessageQueue 管家，调用 Looper 的 <code>loop()</code> 方法后，就会进入一个无限循环，每当发现 MessageQueue 中存在的一条消息，就会将它取出，并传递到 Handler 的 handleMessage() 方法中。<code>每个线程只有一个 Looper 对象</code>。</p><h2 id="使用-AsyncTask"><a href="#使用-AsyncTask" class="headerlink" title="使用 AsyncTask"></a>使用 AsyncTask</h2><p>由于 AsyncTask 是一个抽象类，所以我们需要<code>创建一个子类去继承</code>。</p><h3 id="AsyncTask-类的-3-个泛型参数："><a href="#AsyncTask-类的-3-个泛型参数：" class="headerlink" title="AsyncTask 类的 3 个泛型参数："></a>AsyncTask 类的 3 个泛型参数：</h3><ul><li>Params ：在执行 AsyncTask 时需要传入的参数，可用于在后台任务中使用。</li><li>Progress ：后台任务执行时，如果需要在界面上显示当前的进度，则使用这里指定的泛型为进度单位。</li><li>Result ：当任务执行完毕后，如果需要对结果进行返回，则使用这里指定的泛型作为返回值类型。</li></ul><h3 id="AsyncTask-几个方法："><a href="#AsyncTask-几个方法：" class="headerlink" title="AsyncTask 几个方法："></a>AsyncTask 几个方法：</h3><ul><li><p>onPreExecute() ：<br>这个方法会在<code>后台任务开始执行之前调用</code>，用于进行一些界面上的初始化操作，比如显示一个进度条对话框。</p></li><li><p>doInBackground(Params…) :<br>1、 所有代码都会在子线程中运行；<br>2、 任务一旦完成就会返回 return 语句，但如果 AsyncTask 第三个泛型参数为 Void，则不返回任务执行结果；<br>3、 这个方法中不可以执行 UI 操作，如果要执行 UI 操作，则可以调用 publishProgress(Progress…) 方法完成；</p></li><li><p>onProgressUpdate(Progress…) ：<br>当后台任务中调用 publishProgress(Progress…) 方法后，onProgressUpdate(Progress…) 方法就会调用。</p></li><li><p>onPostExcute(Result) ：<br>当<code>后台任务执行完毕</code>并通过 return 语句执行返回时，这个方法就会调用。</p></li></ul><h3 id="AsyncTask-总结"><a href="#AsyncTask-总结" class="headerlink" title="AsyncTask 总结"></a>AsyncTask 总结</h3><p>doInBackground(Params…) 执行具体的耗时任务；<br>onProgressUpdate(Progress…) 进行更新 UI；<br>onProgressUpdate(Progress…) 执行任务收尾；</p><p>启动这个任务：<code>new targetTask().execute();</code></p><h1 id="服务的基本用法"><a href="#服务的基本用法" class="headerlink" title="服务的基本用法"></a>服务的基本用法</h1><h2 id="定义一个服务"><a href="#定义一个服务" class="headerlink" title="定义一个服务"></a>定义一个服务</h2><p>创建一个 Service 并在 AndroidManifest 中注册，其中 <code>Exported</code> 属性表示是否允许除了当前程序之外的其他程序访问这个服务，<code>Enabled</code> 属性表示是否启用这个服务。</p><h2 id="活动和服务进行通信"><a href="#活动和服务进行通信" class="headerlink" title="活动和服务进行通信"></a>活动和服务进行通信</h2><ol><li>创建一个子类继承 Service</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">public class xxxService extends Service&#123;</span><br><span class="line"></span><br><span class="line">  private final IBinder mBinder = new LocalBinder();</span><br><span class="line"></span><br><span class="line">    public class LocalBinder extends Binder &#123;</span><br><span class="line">        public xxxService getService() &#123;</span><br><span class="line">            return xxxService.this;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public IBinder onBind(Intent intent) &#123;</span><br><span class="line">        return mBinder;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="2"><li>在 Activity/Fragment 中调用 Service：</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">public class MainActivity extends AppCompatActivity&#123;</span><br><span class="line">  private xxxService.LocalBinder localBinder;</span><br><span class="line">  private xxxService mxxxService;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 绑定 xxxService 服务结果回调</span><br><span class="line">     */</span><br><span class="line">    private ServiceConnection serviceConnection = new ServiceConnection() &#123;</span><br><span class="line">        @Override</span><br><span class="line">        public void onServiceConnected(ComponentName name, IBinder service) &#123;</span><br><span class="line">            localBinder = (xxxService.LocalBinder) service; //通过向下转型得到 localBinder 实例</span><br><span class="line">            mxxxService = localBinder.getService();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        @Override</span><br><span class="line">        public void onServiceDisconnected(ComponentName name) &#123;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">   @Override</span><br><span class="line">   public void onCreate(Bundle savedInstanceState) &#123;</span><br><span class="line">       super.onCreate(savedInstanceState);</span><br><span class="line"></span><br><span class="line">       Intent bindIntent = new Intent(this, xxxService.class);</span><br><span class="line">       bindService(bindIntent, serviceConnection, Context.BIND_AUTO_CREATE); //绑定服务获取持久连接</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   @Override</span><br><span class="line">   public void onDestroy() &#123;</span><br><span class="line">       super.onDestroy();</span><br><span class="line">       unbindService(serviceConnection);</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="服务的更多技巧"><a href="#服务的更多技巧" class="headerlink" title="服务的更多技巧"></a>服务的更多技巧</h1><h2 id="使用前台服务"><a href="#使用前台服务" class="headerlink" title="使用前台服务"></a>使用前台服务</h2><p>前台服务和普通服务最大区别是，它会一直有一个正在运行的图标在系统的状态栏显示，下拉状态栏可以看到更加详细的信息。类似于彩云天气的前台服务效果。</p><h2 id="使用-IntentService"><a href="#使用-IntentService" class="headerlink" title="使用 IntentService"></a>使用 IntentService</h2><p>一个异步的、会自动停止的服务。<code>onHandleIntent(Intent intent)</code> 方法运行在子线程中。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">public class xxxIntentService extends IntentService&#123;</span><br><span class="line"></span><br><span class="line">    public xxxIntentService()&#123;</span><br><span class="line">      super(&quot;xxxIntentService&quot;); //调用父类的有参构造函数</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    protected void onHandleIntent(Intent intent) &#123;</span><br><span class="line"></span><br><span class="line">      //当前的逻辑已经在子线程中运行</span><br><span class="line"></span><br><span class="line">      //打印当前线程的 id</span><br><span class="line">      Log.d(&quot;xxxIntentService&quot;, &quot;Thread id is&quot; + Thread.currentThread().getId());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    protected void onDestroy() &#123;</span><br><span class="line">      super.onDestroy();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;定义&quot;&gt;&lt;a href=&quot;#定义&quot; class=&quot;headerlink&quot; title=&quot;定义&quot;&gt;&lt;/a&gt;定义&lt;/h1&gt;&lt;blockquote&gt;
&lt;p&gt;&lt;code&gt;服务&lt;/code&gt;是 Android 中实现程序后台运行的解决方案，它非常适合去执行那些&lt;code&gt;不
      
    
    </summary>
    
      <category term="Android" scheme="http://yoursite.com/categories/Android/"/>
    
    
      <category term="Android" scheme="http://yoursite.com/tags/Android/"/>
    
      <category term="Service" scheme="http://yoursite.com/tags/Service/"/>
    
      <category term="线程" scheme="http://yoursite.com/tags/%E7%BA%BF%E7%A8%8B/"/>
    
  </entry>
  
  <entry>
    <title>Broadcast 使用</title>
    <link href="http://yoursite.com/2018/07/05/Broadcast%E4%BD%BF%E7%94%A8/"/>
    <id>http://yoursite.com/2018/07/05/Broadcast使用/</id>
    <published>2018-07-05T05:47:25.000Z</published>
    <updated>2018-07-05T16:06:00.904Z</updated>
    
    <content type="html"><![CDATA[<h1 id="广播机制"><a href="#广播机制" class="headerlink" title="广播机制"></a>广播机制</h1><ul><li>标准广播  完全异步执行，所有广播接收器同时接收</li><li>有序广播 同步执行，同一时刻只有一个广播接收器可以接收</li></ul><h1 id="接收系统广播"><a href="#接收系统广播" class="headerlink" title="接收系统广播"></a>接收系统广播</h1><h2 id="动态注册监听网络变化"><a href="#动态注册监听网络变化" class="headerlink" title="动态注册监听网络变化"></a>动态注册监听网络变化</h2><p>动态注册的广播接收器可以随意地控制注册和注销，但必须要在程序启动之后才能街道广播。</p><h2 id="静态注册实现开机启动"><a href="#静态注册实现开机启动" class="headerlink" title="静态注册实现开机启动"></a>静态注册实现开机启动</h2><h1 id="发送自定义广播"><a href="#发送自定义广播" class="headerlink" title="发送自定义广播"></a>发送自定义广播</h1><h2 id="发送标准广播"><a href="#发送标准广播" class="headerlink" title="发送标准广播"></a>发送标准广播</h2><h2 id="发送有序广播"><a href="#发送有序广播" class="headerlink" title="发送有序广播"></a>发送有序广播</h2><p>使用 <code>sendOrderBrocast()</code> 发送广播，同时需要在 AndroidManifest 中设置优先级 <code>&lt;intent-filter android:priority= &gt;</code></p><h1 id="使用本地广播"><a href="#使用本地广播" class="headerlink" title="使用本地广播"></a>使用本地广播</h1><p><code>LocalBroadcastManger</code> 来管理广播。<br><code>LocalBroadcastManger localBroadcastmanger = LocalBroadcastManger.getInstance(this);</code> 获取 <code>LocalBroadcastManger</code> 实例。<br><code>localBroadcastmanger.sendBroadcast()</code> 发送广播。<br><code>localBroadcastmanger.registerReceiver()</code> 注册广播。<br><code>localBroadcastmanger.unregisterReceiver()</code> 注销广播。</p><h1 id="利用广播实现强制下线功能"><a href="#利用广播实现强制下线功能" class="headerlink" title="利用广播实现强制下线功能"></a>利用广播实现强制下线功能</h1><ol><li><p>首先定义一个活动回收器 <code>ActivityCollector</code> 类，创建一个列表来管理活动，<code>ActivityCollector</code> 类里面包含添加活动 <code>addActivity</code>、移除活动 <code>removeActivity</code>、结束活动 <code>finishAll</code> 的方法。</p></li><li><p>创建一个 <code>BaseActivity</code> 类作为所有活动的父类，同时复写 <code>onCreate</code> 添加 <code>addActivity</code> 方法；复写 <code>onDestroy</code> 添加 <code>removeActivity</code> 方法；复写 <code>onResume</code> 在里面注册广播；复写 <code>onPause</code> 在里面注销广播；在 <code>ForceOfflineReceiver</code> 的 <code>onReceive</code> 方法里面放入 <code>finishAll</code> 方法。</p></li><li><p>让需要实现强制下线功能的 Activity 继承 <code>BaseActivity</code> 类，同时发送强制下线功能的广播。</p></li></ol><h1 id="利用静态广播实现-APP-开机自动启动"><a href="#利用静态广播实现-APP-开机自动启动" class="headerlink" title="利用静态广播实现 APP 开机自动启动"></a>利用静态广播实现 APP 开机自动启动</h1>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;广播机制&quot;&gt;&lt;a href=&quot;#广播机制&quot; class=&quot;headerlink&quot; title=&quot;广播机制&quot;&gt;&lt;/a&gt;广播机制&lt;/h1&gt;&lt;ul&gt;
&lt;li&gt;标准广播  完全异步执行，所有广播接收器同时接收&lt;/li&gt;
&lt;li&gt;有序广播 同步执行，同一时刻只有一个广播接收
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>ViewPager使用</title>
    <link href="http://yoursite.com/2018/07/05/ViewPager%E4%BD%BF%E7%94%A8/"/>
    <id>http://yoursite.com/2018/07/05/ViewPager使用/</id>
    <published>2018-07-05T05:47:02.000Z</published>
    <updated>2018-07-05T05:47:02.958Z</updated>
    
    <summary type="html">
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>Java 获取时间日期方法</title>
    <link href="http://yoursite.com/2018/07/05/Java%20%E8%8E%B7%E5%8F%96%E5%BD%93%E5%89%8D%E6%97%B6%E9%97%B4%E6%96%B9%E6%B3%95/"/>
    <id>http://yoursite.com/2018/07/05/Java 获取当前时间方法/</id>
    <published>2018-07-05T05:46:33.000Z</published>
    <updated>2018-07-05T10:42:04.975Z</updated>
    
    <content type="html"><![CDATA[<h2 id="单个获取年、月、日、时、分"><a href="#单个获取年、月、日、时、分" class="headerlink" title="单个获取年、月、日、时、分"></a>单个获取年、月、日、时、分</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">public static int getYear() &#123;</span><br><span class="line">        //获取系统的日期</span><br><span class="line">        Calendar calendar = Calendar.getInstance();</span><br><span class="line">        //年</span><br><span class="line">        int year = calendar.get(Calendar.YEAR);</span><br><span class="line"></span><br><span class="line">        return year;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public static int getMonth() &#123;</span><br><span class="line">        Calendar calendar = Calendar.getInstance();</span><br><span class="line"></span><br><span class="line">        //月份需要加 1，因为是从 0 开始算的</span><br><span class="line">        int month = calendar.get(Calendar.MONTH) + 1;</span><br><span class="line"></span><br><span class="line">        return month;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public static int getDay() &#123;</span><br><span class="line">        Calendar calendar = Calendar.getInstance();</span><br><span class="line"></span><br><span class="line">        int day = calendar.get(Calendar.DAY_OF_MONTH);</span><br><span class="line"></span><br><span class="line">        return day;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public static int getHour() &#123;</span><br><span class="line">        Calendar calendar = Calendar.getInstance();</span><br><span class="line"></span><br><span class="line">        int hour = calendar.get(Calendar.HOUR_OF_DAY);</span><br><span class="line"></span><br><span class="line">        return hour;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public static int getMinute() &#123;</span><br><span class="line">        Calendar calendar = Calendar.getInstance();</span><br><span class="line"></span><br><span class="line">        int minute = calendar.get(Calendar.MINUTE);</span><br><span class="line"></span><br><span class="line">        return minute;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h2 id="获取当前时间"><a href="#获取当前时间" class="headerlink" title="获取当前时间"></a>获取当前时间</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line">     * 获取当前时间的年月日</span><br><span class="line">     * @return</span><br><span class="line">     */</span><br><span class="line">    public static String simpleDate()&#123;</span><br><span class="line">        SimpleDateFormat simpleDateFormat = new SimpleDateFormat(&quot;yyyy年MM月dd日&quot;);</span><br><span class="line">        Date date = new Date(System.currentTimeMillis());</span><br><span class="line"></span><br><span class="line">        return simpleDateFormat.format(date);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h2 id="以当前时间为原点，往前或往后查询某一天"><a href="#以当前时间为原点，往前或往后查询某一天" class="headerlink" title="以当前时间为原点，往前或往后查询某一天"></a>以当前时间为原点，往前或往后查询某一天</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line">     * 显示某一日的数据</span><br><span class="line">     * @param dateIndex</span><br><span class="line">     * @return</span><br><span class="line">     */</span><br><span class="line">    public static String getDisplayOffsetDate(int dateIndex)&#123;</span><br><span class="line">        SimpleDateFormat simpleDateFormat = new SimpleDateFormat(&quot;yyyy年MM月dd日&quot;);</span><br><span class="line">        if (dateIndex == 0)&#123;</span><br><span class="line">            Date date = new Date(System.currentTimeMillis());</span><br><span class="line">            return simpleDateFormat.format(date);</span><br><span class="line">        &#125;else &#123;</span><br><span class="line">            Date beginDate = new Date();//获取当天 年月日+时间+时区</span><br><span class="line">            Calendar date = Calendar.getInstance();//获取当天更加详细时间</span><br><span class="line">            date.setTime(beginDate);</span><br><span class="line">            date.set(Calendar.DATE, date.get(Calendar.DATE) + dateIndex);</span><br><span class="line">            Date endDate = null;</span><br><span class="line">            try &#123;</span><br><span class="line">                endDate = simpleDateFormat.parse(simpleDateFormat.format(date.getTime()));</span><br><span class="line">            &#125; catch (ParseException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">            return simpleDateFormat.format(endDate);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>如果查询某一年、某一月，则改变 <code>Calendar.DATE</code> 为 <code>YEAR</code> 或 <code>MONTH</code>。</p><h2 id="查询某一个月有多少天"><a href="#查询某一个月有多少天" class="headerlink" title="查询某一个月有多少天"></a>查询某一个月有多少天</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * 查询某一个月一共有多少天</span><br><span class="line"> * @param date</span><br><span class="line"> * @return</span><br><span class="line"> */</span><br><span class="line">public static int getDaysOfMonth(String date)&#123;</span><br><span class="line">    SimpleDateFormat simpleDateFormat = new SimpleDateFormat(&quot;yyyy年MM月&quot;);</span><br><span class="line">    Date timeMillis = new Date();</span><br><span class="line">    try &#123;</span><br><span class="line">        timeMillis = simpleDateFormat.parse(date);</span><br><span class="line">    &#125; catch (ParseException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">    Calendar calendar = Calendar.getInstance();</span><br><span class="line">    calendar.setTime(timeMillis);</span><br><span class="line">    return calendar.getActualMaximum(Calendar.DAY_OF_MONTH);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="设置-calendar-的时间为-2000-01-01-00-00，并获取-1970至2000-01-01-00-00时间的毫秒"><a href="#设置-calendar-的时间为-2000-01-01-00-00，并获取-1970至2000-01-01-00-00时间的毫秒" class="headerlink" title="设置 calendar 的时间为 2000-01-01-00-00，并获取 1970至2000-01-01-00-00时间的毫秒"></a>设置 calendar 的时间为 2000-01-01-00-00，并获取 1970至2000-01-01-00-00时间的毫秒</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * 2000-01-01-00-00</span><br><span class="line"> * @return</span><br><span class="line"> */</span><br><span class="line">public static Calendar get20000101Datetime() &#123;</span><br><span class="line">    Calendar cal_ = Calendar.getInstance();</span><br><span class="line">    cal_.set(Calendar.YEAR, 2000);</span><br><span class="line">    cal_.set(Calendar.MONTH, Calendar.JANUARY);</span><br><span class="line">    cal_.set(Calendar.DATE, 1);</span><br><span class="line">    cal_.set(Calendar.HOUR_OF_DAY, 0);</span><br><span class="line">    cal_.set(Calendar.MINUTE, 0);</span><br><span class="line">    cal_.set(Calendar.SECOND, 0);</span><br><span class="line">    cal_.set(Calendar.MILLISECOND, 0);</span><br><span class="line"></span><br><span class="line">    return cal_;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">//设置 calendar 的时间为 2000-01-01-00-00</span><br><span class="line">Calendar calendar = get20000101Datetime();</span><br><span class="line">//setTimeInMillis 为 （1970至2000-01-01-00-00时间的毫秒）</span><br><span class="line">calendar.getTimeInMillis();</span><br></pre></td></tr></table></figure><h2 id="把-String-类型的日期，转换为日期的毫秒数"><a href="#把-String-类型的日期，转换为日期的毫秒数" class="headerlink" title="把 String 类型的日期，转换为日期的毫秒数"></a>把 String 类型的日期，转换为日期的毫秒数</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * 把 String 类型的日期，转换为日期的毫秒数</span><br><span class="line"> * @param i</span><br><span class="line"> * @return</span><br><span class="line"> */</span><br><span class="line">public static Long stringToDateMillis(String i)&#123;</span><br><span class="line">    SimpleDateFormat simpleDateFormat = new SimpleDateFormat(&quot;yyyy年MM月dd日 HH:mm&quot;);//24小时制</span><br><span class="line">    long timeMillis = 0;</span><br><span class="line">    try &#123;</span><br><span class="line">        timeMillis = simpleDateFormat.parse(i).getTime();</span><br><span class="line">    &#125; catch (ParseException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    return timeMillis;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;单个获取年、月、日、时、分&quot;&gt;&lt;a href=&quot;#单个获取年、月、日、时、分&quot; class=&quot;headerlink&quot; title=&quot;单个获取年、月、日、时、分&quot;&gt;&lt;/a&gt;单个获取年、月、日、时、分&lt;/h2&gt;&lt;figure class=&quot;highlight plai
      
    
    </summary>
    
      <category term="Java" scheme="http://yoursite.com/categories/Java/"/>
    
    
      <category term="Java" scheme="http://yoursite.com/tags/Java/"/>
    
      <category term="时间" scheme="http://yoursite.com/tags/%E6%97%B6%E9%97%B4/"/>
    
  </entry>
  
  <entry>
    <title>BLE 开发知识</title>
    <link href="http://yoursite.com/2018/07/05/BLE%20%E5%BC%80%E5%8F%91%E7%9F%A5%E8%AF%86/"/>
    <id>http://yoursite.com/2018/07/05/BLE 开发知识/</id>
    <published>2018-07-05T05:20:32.000Z</published>
    <updated>2018-07-06T01:35:14.645Z</updated>
    
    <content type="html"><![CDATA[<h1 id="开发流程"><a href="#开发流程" class="headerlink" title="开发流程"></a>开发流程</h1><h2 id="声明-BLE-权限"><a href="#声明-BLE-权限" class="headerlink" title="声明 BLE 权限"></a>声明 BLE 权限</h2><p>在 AndroidManifest 中添加：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;uses-permission android:name=&quot;android.permission.BLUETOOTH&quot; /&gt;</span><br><span class="line">&lt;uses-permission android:name=&quot;android.permission.BLUETOOTH_ADMIN&quot; /&gt;</span><br><span class="line">&lt;!-- 6.0 之后需要位置权限--&gt;</span><br><span class="line">&lt;uses-permission android:name=&quot;android.permission.ACCESS_COARSE_LOCATION&quot; /&gt;</span><br><span class="line">&lt;uses-permission android:name=&quot;android.permission.ACCESS_FINE_LOCATION&quot; /&gt;</span><br></pre></td></tr></table></figure><h2 id="获取-BluetoothAdapter-实例"><a href="#获取-BluetoothAdapter-实例" class="headerlink" title="获取 BluetoothAdapter 实例"></a>获取 BluetoothAdapter 实例</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * 初始化本地蓝牙</span><br><span class="line"> *</span><br><span class="line"> * @return</span><br><span class="line"> */</span><br><span class="line">private boolean initBLE() &#123;</span><br><span class="line">    if (mBluetoothManager == null) &#123;</span><br><span class="line">        mBluetoothManager = (BluetoothManager) getSystemService(Context.BLUETOOTH_SERVICE);</span><br><span class="line">        if (mBluetoothManager == null) &#123;</span><br><span class="line">            LogUtil.e(TAG, &quot;Unable to initialize BluetoothManager.&quot;);</span><br><span class="line">            return false;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    mBluetoothAdapter = mBluetoothManager.getAdapter();</span><br><span class="line">    if (mBluetoothAdapter == null) &#123;</span><br><span class="line">        LogUtil.e(TAG, &quot;Unable to obtain a BluetoothAdapter.&quot;);</span><br><span class="line">        return false;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    return true;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="动态申请定位权限"><a href="#动态申请定位权限" class="headerlink" title="动态申请定位权限"></a>动态申请定位权限</h2><p>Android 6.0 系统以上开启蓝牙还需要定位权限，定位权限属于危险权限，需要动态申请：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">private void initPermission() &#123;</span><br><span class="line">    if (ContextCompat.checkSelfPermission(MainActivity.this,</span><br><span class="line">            Manifest.permission.ACCESS_COARSE_LOCATION)</span><br><span class="line">            != PackageManager.PERMISSION_GRANTED) &#123;</span><br><span class="line">              ……………………</span><br><span class="line">        //请求权限</span><br><span class="line">        requestPermissions(new String[]&#123;Manifest.permission.WRITE_CONTACTS&#125;,</span><br><span class="line">                MY_PERMISSIONS_REQUEST_ACCESS_COARSE_LOCATION);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>如果是在 Fragment 中使用，则是</p><p><code>xxxFragment.this.requestPermissions</code></p><p><code>requestPermissions</code> 的回调方法是</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">@Override</span><br><span class="line">public void onRequestPermissionsResult(int requestCode, @NonNull String[] permissions, @NonNull int[] grantResults) &#123;</span><br><span class="line">    super.onRequestPermissionsResult(requestCode, permissions, grantResults);</span><br><span class="line">    switch (requestCode) &#123;</span><br><span class="line">        case MY_PERMISSIONS_REQUEST_ACCESS_COARSE_LOCATION:</span><br><span class="line">            Toast.makeText(getActivity(), &quot;已经可以定位了&quot;, Toast.LENGTH_SHORT).show();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="请求位置服务"><a href="#请求位置服务" class="headerlink" title="请求位置服务"></a>请求位置服务</h2><p>判断是否开启定位功能<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * 开启定位功能</span><br><span class="line"> * @param context</span><br><span class="line"> * @return</span><br><span class="line"> */</span><br><span class="line">private static boolean isLocationEnable(Context context) &#123;</span><br><span class="line">    LocationManager locationManager = (LocationManager) context.getSystemService(Context.LOCATION_SERVICE);</span><br><span class="line">    boolean networkProvider = locationManager.isProviderEnabled(LocationManager.NETWORK_PROVIDER);</span><br><span class="line">    boolean gpsProvider = locationManager.isProviderEnabled(LocationManager.GPS_PROVIDER);</span><br><span class="line">    if (networkProvider || gpsProvider) &#123;</span><br><span class="line">        return true;</span><br><span class="line">    &#125;</span><br><span class="line">    return false;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>开启定位服务<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * 获取定位服务</span><br><span class="line"> *</span><br><span class="line"> * @param context</span><br><span class="line"> */</span><br><span class="line">private static void setLocationService(Context context) &#123;</span><br><span class="line">    Intent locationIntent = new Intent(Settings.ACTION_LOCATION_SOURCE_SETTINGS);</span><br><span class="line">    ((Activity) context).startActivityForResult(locationIntent, Global.REQUEST_CODE_LOCATION_SETTINGS);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h2 id="扫描设备"><a href="#扫描设备" class="headerlink" title="扫描设备"></a>扫描设备</h2><p>在 android 6.0 中，使用 BluetoothLeScanner.startScan() 来扫描的：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * 扫描 BLE 设备</span><br><span class="line"> * @param enable</span><br><span class="line"> */</span><br><span class="line">public void scanDevices(boolean enable) &#123;</span><br><span class="line">    LogUtil.i(TAG, &quot;BluetoothAdapter 状态：&quot; + mBluetoothAdapter.getState());</span><br><span class="line">    if (enable) &#123;</span><br><span class="line">          /*new Handler().postDelayed(new Runnable() &#123;</span><br><span class="line">            @Override</span><br><span class="line">            public void run() &#123;</span><br><span class="line">                mBluetoothAdapter.getBluetoothLeScanner().stopScan(mScanCallback);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;, 3000);*/</span><br><span class="line"></span><br><span class="line">        LogUtil.i(TAG, &quot;正在搜索设备…………&quot;);</span><br><span class="line">        mBluetoothAdapter.getBluetoothLeScanner().startScan(mScanCallback);</span><br><span class="line"></span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        LogUtil.i(TAG, &quot;停止搜索设备&quot;);</span><br><span class="line">        mBluetoothAdapter.getBluetoothLeScanner().stopScan(mScanCallback);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">private ScanCallback mScanCallback = new ScanCallback() &#123;</span><br><span class="line">    @Override</span><br><span class="line">    public void onScanResult(int callbackType, ScanResult result) &#123;</span><br><span class="line">        super.onScanResult(callbackType, result);</span><br><span class="line">        Bundle data = new Bundle();</span><br><span class="line">        data.putParcelable(BluetoothDevice.EXTRA_DEVICE, result.getDevice());</span><br><span class="line"></span><br><span class="line">        Intent intent = new Intent();</span><br><span class="line">        intent.setAction(ACTION_DEVICE_FOUND);</span><br><span class="line">        intent.putExtras(data);</span><br><span class="line">        sendBroadcast(intent);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h2 id="注册广播"><a href="#注册广播" class="headerlink" title="注册广播"></a>注册广播</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * 初始化广播</span><br><span class="line"> */</span><br><span class="line">private void initBroadcastReceiver() &#123;</span><br><span class="line">    IntentFilter intentFilter = new IntentFilter();</span><br><span class="line"></span><br><span class="line">    intentFilter.addAction(BluetoothAdapter.ACTION_STATE_CHANGED);</span><br><span class="line">    intentFilter.addAction(BluetoothService.ACTION_DEVICE_FOUND);</span><br><span class="line">    intentFilter.addAction(BluetoothService.ACTION_GATT_SERVICES_DISCOVERED_SUCCESS);</span><br><span class="line">    intentFilter.addAction(BluetoothService.ACTION_GATT_DESCRIPTOR_WRITE_SUCCESS);</span><br><span class="line">    intentFilter.addAction(BluetoothService.ACTION_GATT_CHARACTERISTIC_WRITE_SUCCESS);</span><br><span class="line">    intentFilter.addAction(BluetoothService.ACTION_GATT_CHARACTERISTIC_DATA_REPLY);</span><br><span class="line"></span><br><span class="line">    registerReceiver(broadcastReceiver, intentFilter);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * 广播接收器</span><br><span class="line"> */</span><br><span class="line">private BroadcastReceiver broadcastReceiver = new BroadcastReceiver() &#123;</span><br><span class="line">    @Override</span><br><span class="line">    public void onReceive(Context context, Intent intent) &#123;</span><br><span class="line">        String action = intent.getAction();</span><br><span class="line"></span><br><span class="line">        if (action.equals(BluetoothAdapter.ACTION_STATE_CHANGED)) &#123;</span><br><span class="line">            …………</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure><h2 id="连接设备"><a href="#连接设备" class="headerlink" title="连接设备"></a>连接设备</h2><p>需要获取 <code>BluetoothGATT</code> 再进行操作：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * 连接目标 BLE 设备</span><br><span class="line"> *</span><br><span class="line"> * @param address</span><br><span class="line"> * @return</span><br><span class="line"> */</span><br><span class="line">public boolean connect(final String address) &#123;</span><br><span class="line"></span><br><span class="line">    if (mBluetoothAdapter == null || address == null) &#123;</span><br><span class="line">        LogUtil.e(TAG, &quot;BluetoothAdapter not initialized or unspecified address.&quot;);</span><br><span class="line">        return false;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    final BluetoothDevice device = mBluetoothAdapter.getRemoteDevice(address);</span><br><span class="line">    if (device == null) &#123;</span><br><span class="line">        LogUtil.e(TAG, &quot;Device not found.  Unable to connect.&quot;);</span><br><span class="line">        return false;</span><br><span class="line">    &#125;</span><br><span class="line">    // We want to directly connect to the device, so we are setting the autoConnect</span><br><span class="line">    // parameter to false.</span><br><span class="line">    mBluetoothGatt = device.connectGatt(this, false, mGattCallback);</span><br><span class="line">    LogUtil.i(TAG, &quot;成功连接上设备：&quot; + device.getName());</span><br><span class="line">    LogUtil.i(TAG, &quot;------------Create a new connection.------------&quot;);</span><br><span class="line"></span><br><span class="line">    return true;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>当 GATT 客户端连接上或者连接状态改变时，调用 <code>onConnectionStateChange</code>。</p><p>如果使用：<code>device.connectGatt(Context context, boolean autoConnect, BluetoothGattCallback callback, int transport)</code></p><p>根据源码 <code>@param transport preferred transport for GATT connections to remote dual-mode devices</code><br>跟双模设备连接，<code>transport</code> 如果不传默认 <code>TRANSPORT_AUTO</code>，6.0系统及以上需要使用 <code>TRANSPORT_LE</code> 这种传输模式。</p><h2 id="发现服务"><a href="#发现服务" class="headerlink" title="发现服务"></a>发现服务</h2><p>当使用 <code>mBluetoothGatt.discoverServices()</code> 时，则调用 <code>onServicesDiscovered</code>。</p><h2 id="获取-BluetoothGattService-和-BluetoothGattCharacteristic"><a href="#获取-BluetoothGattService-和-BluetoothGattCharacteristic" class="headerlink" title="获取 BluetoothGattService 和 BluetoothGattCharacteristic"></a>获取 BluetoothGattService 和 BluetoothGattCharacteristic</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line">     * 获取 BluetoothGattService</span><br><span class="line">     *</span><br><span class="line">     * @param bluetoothGatt</span><br><span class="line">     * @param uuid_service</span><br><span class="line">     * @return</span><br><span class="line">     */</span><br><span class="line">    private BluetoothGattService getBluetoothGATTService(BluetoothGatt bluetoothGatt, UUID uuid_service) &#123;</span><br><span class="line">        if (mBluetoothGatt != null) &#123;</span><br><span class="line">            BluetoothGattService bluetoothGattService = mBluetoothGatt.getService(uuid_service);</span><br><span class="line">            if (bluetoothGattService != null) &#123;</span><br><span class="line">                //LogUtil.i(TAG, &quot;成功获取 bluetoothGattService：&quot; + uuid_service);</span><br><span class="line">                return bluetoothGattService;</span><br><span class="line">            &#125; else &#123;</span><br><span class="line">                LogUtil.e(TAG, &quot;bluetoothgatt get service uuid:&quot; + uuid_service + &quot; is null&quot;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            LogUtil.e(TAG, &quot;mBluetoothGatt is null&quot;);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        return null;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 获取 BluetoothGattCharacteristic</span><br><span class="line">     *</span><br><span class="line">     * @param bluetoothGattService</span><br><span class="line">     * @param uuid_characteristic</span><br><span class="line">     * @return</span><br><span class="line">     */</span><br><span class="line">    private BluetoothGattCharacteristic getBluetoothGattCharacteristic(BluetoothGattService bluetoothGattService, UUID uuid_characteristic) &#123;</span><br><span class="line">        if (bluetoothGattService != null) &#123;</span><br><span class="line">            BluetoothGattCharacteristic bluetoothGattCharacteristic = bluetoothGattService.getCharacteristic(uuid_characteristic);</span><br><span class="line">            if (bluetoothGattCharacteristic != null) &#123;</span><br><span class="line">                //LogUtil.i(TAG, &quot;成功获取 bluetoothGattCharacteristic：&quot; + uuid_characteristic);</span><br><span class="line">                return bluetoothGattCharacteristic;</span><br><span class="line">            &#125; else &#123;</span><br><span class="line">                LogUtil.e(TAG, &quot;bluetoothGattService get characteristic uuid:&quot; + uuid_characteristic + &quot; is null&quot;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            LogUtil.e(TAG, &quot;bluetoothGattService is null&quot;);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        return null;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h2 id="开启通知，并且写入-Descriptor"><a href="#开启通知，并且写入-Descriptor" class="headerlink" title="开启通知，并且写入 Descriptor"></a>开启通知，并且写入 Descriptor</h2><p><code>WriteCharacteristic()</code> 后有数据返回，则需要先：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line">     * 设置 Characteristic 通知属性，并且写上 Descriptor</span><br><span class="line">     */</span><br><span class="line">    private void setCharacteristicNotifyAndWriteDescriptor(UUID uuid_service, UUID uuid_characteristic, UUID uuid_descriptor) &#123;</span><br><span class="line"></span><br><span class="line">        BluetoothGattService mBluetoothGattService = getBluetoothGATTService(mBluetoothGatt, uuid_service);</span><br><span class="line"></span><br><span class="line">        BluetoothGattCharacteristic mBluetoothGattCharacteristic = getBluetoothGattCharacteristic(mBluetoothGattService, uuid_characteristic);</span><br><span class="line"></span><br><span class="line">        if (mBluetoothGatt != null &amp;&amp; mBluetoothGattCharacteristic != null) &#123;</span><br><span class="line">            mBluetoothGatt.setCharacteristicNotification(mBluetoothGattCharacteristic, true);</span><br><span class="line"></span><br><span class="line">            BluetoothGattDescriptor mBluetoothGattDescriptor = mBluetoothGattCharacteristic.getDescriptor(uuid_descriptor);</span><br><span class="line">            if (mBluetoothGattDescriptor != null) &#123;</span><br><span class="line">                LogUtil.i(TAG, &quot;成功设置 mBluetoothGattDescriptor&quot;);</span><br><span class="line">                mBluetoothGattDescriptor.setValue(BluetoothGattDescriptor.ENABLE_NOTIFICATION_VALUE);</span><br><span class="line">                mBluetoothGatt.writeDescriptor(mBluetoothGattDescriptor);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125; else if (mBluetoothGatt == null) &#123;</span><br><span class="line">            LogUtil.e(TAG, &quot;mBluetoothGatt is null&quot;);</span><br><span class="line">        &#125; else if (mBluetoothGattCharacteristic == null) &#123;</span><br><span class="line">            LogUtil.e(TAG, &quot;mBluetoothGattCharacteristic is null&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>然后会回调 <code>onDescriptorWrite</code></p><h2 id="写入-Characteristic"><a href="#写入-Characteristic" class="headerlink" title="写入 Characteristic"></a>写入 Characteristic</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * 写入 Characteristic</span><br><span class="line"> * @param uuid_service</span><br><span class="line"> * @param uuid_characteristic</span><br><span class="line"> * @param value</span><br><span class="line"> */</span><br><span class="line">private void writeCharacteristic(UUID uuid_service, UUID uuid_characteristic, byte[] value) &#123;</span><br><span class="line">    BluetoothGattService mBluetoothGattService = getBluetoothGATTService(mBluetoothGatt, uuid_service);</span><br><span class="line"></span><br><span class="line">    BluetoothGattCharacteristic mBluetoothGattCharacteristic = getBluetoothGattCharacteristic(mBluetoothGattService, uuid_characteristic);</span><br><span class="line"></span><br><span class="line">    if (mBluetoothGatt != null &amp;&amp; mBluetoothGattCharacteristic != null) &#123;</span><br><span class="line">        mBluetoothGattCharacteristic.setValue(value);</span><br><span class="line">        mBluetoothGattCharacteristic.setWriteType(BluetoothGattCharacteristic.WRITE_TYPE_NO_RESPONSE);</span><br><span class="line">        mBluetoothGatt.writeCharacteristic(mBluetoothGattCharacteristic);</span><br><span class="line"></span><br><span class="line">    &#125;else if (mBluetoothGatt == null) &#123;</span><br><span class="line">        LogUtil.e(TAG, &quot;mBluetoothGatt is null&quot;);</span><br><span class="line">    &#125; else if (mBluetoothGattCharacteristic == null) &#123;</span><br><span class="line">        LogUtil.e(TAG, &quot;mBluetoothGattCharacteristic is null&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>则先回调 <code>onCharacteristicWrite</code>，然后回调 <code>onCharacteristicChanged</code>。</p><h2 id="BluetoothGatt-的回调"><a href="#BluetoothGatt-的回调" class="headerlink" title="BluetoothGatt 的回调"></a>BluetoothGatt 的回调</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * BluetoothGatt 的回调</span><br><span class="line"> */</span><br><span class="line">private BluetoothGattCallback mGattCallback = new BluetoothGattCallback() &#123;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void onConnectionStateChange(BluetoothGatt gatt, int status, int newState) &#123;</span><br><span class="line">        super.onConnectionStateChange(gatt, status, newState);</span><br><span class="line">        if (newState == BluetoothProfile.STATE_CONNECTED) &#123;</span><br><span class="line"></span><br><span class="line">            if (status == BluetoothGatt.GATT_SUCCESS) &#123;</span><br><span class="line">                LogUtil.i(TAG, &quot;Connected To GATT Server&quot;);</span><br><span class="line">                LogUtil.i(TAG, &quot;Attempting To Start Service Discovery:&quot; + mBluetoothGatt.discoverServices());</span><br><span class="line">                broadcastUpdate(ACTION_GATT_CONNECTED);</span><br><span class="line"></span><br><span class="line">            &#125; else &#123;</span><br><span class="line">                disconnect();</span><br><span class="line">                close();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; else if (newState == BluetoothProfile.STATE_DISCONNECTED) &#123;</span><br><span class="line">            close();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void onServicesDiscovered(BluetoothGatt gatt, int status) &#123;</span><br><span class="line">        super.onServicesDiscovered(gatt, status);</span><br><span class="line">        LogUtil.i(TAG, &quot;onServicesDiscovered received: &quot; + status);</span><br><span class="line"></span><br><span class="line">        if (status == BluetoothGatt.GATT_SUCCESS) &#123;</span><br><span class="line">            broadcastUpdate(ACTION_GATT_SERVICES_DISCOVERED_SUCCESS);</span><br><span class="line"></span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            LogUtil.i(TAG, &quot;onServicesDiscovered received: &quot; + status);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void onDescriptorWrite(BluetoothGatt gatt, BluetoothGattDescriptor descriptor, int status) &#123;</span><br><span class="line">        super.onDescriptorWrite(gatt, descriptor, status);</span><br><span class="line">        if (status == BluetoothGatt.GATT_SUCCESS) &#123;</span><br><span class="line">            broadcastUpdate(ACTION_GATT_DESCRIPTOR_WRITE_SUCCESS);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void onCharacteristicWrite(BluetoothGatt gatt, BluetoothGattCharacteristic characteristic, int status) &#123;</span><br><span class="line">        super.onCharacteristicWrite(gatt, characteristic, status);</span><br><span class="line">        if (status == BluetoothGatt.GATT_SUCCESS)&#123;</span><br><span class="line">            broadcastUpdate(ACTION_GATT_CHARACTERISTIC_WRITE_SUCCESS);</span><br><span class="line">            //LogUtil.i(TAG, &quot;onCharacteristicWrite 返回的数据&quot; + Arrays.toString(characteristic.getValue()));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void onCharacteristicChanged(BluetoothGatt gatt, BluetoothGattCharacteristic characteristic) &#123;</span><br><span class="line">        super.onCharacteristicChanged(gatt, characteristic);</span><br><span class="line">        LogUtil.i(TAG, &quot;onCharacteristicChanged 返回的数据&quot; + Arrays.toString(characteristic.getValue()));</span><br><span class="line">        broadcastUpdate(ACTION_GATT_CHARACTERISTIC_DATA_REPLY, KEY_HOUR_DATA, characteristic.getValue());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void onCharacteristicRead(BluetoothGatt gatt, BluetoothGattCharacteristic characteristic, int status) &#123;</span><br><span class="line">        super.onCharacteristicRead(gatt, characteristic, status);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void onDescriptorRead(BluetoothGatt gatt, BluetoothGattDescriptor descriptor, int status) &#123;</span><br><span class="line">        super.onDescriptorRead(gatt, descriptor, status);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h2 id="发送广播"><a href="#发送广播" class="headerlink" title="发送广播"></a>发送广播</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * 发送广播</span><br><span class="line"> *</span><br><span class="line"> * @param action</span><br><span class="line"> */</span><br><span class="line">private void broadcastUpdate(final String action) &#123;</span><br><span class="line">    final Intent intent = new Intent(action);</span><br><span class="line">    sendBroadcast(intent);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">private void broadcastUpdate(final String action, String key, byte[] value)&#123;</span><br><span class="line">    final Intent intent = new Intent(action);</span><br><span class="line">    intent.putExtra(key, value);</span><br><span class="line">    sendBroadcast(intent);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><ul><li><p><a href="https://blog.csdn.net/qingtiantianqing/article/details/52459629?locationNum=13" target="_blank" rel="noopener">Android蓝牙4.0 BLE开发坑总结</a></p></li><li><p><a href="http://a1anwang.com/post-18.html" target="_blank" rel="noopener">Android BLE 多次writeCharacteristic 为什么只有一个回调</a></p></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;开发流程&quot;&gt;&lt;a href=&quot;#开发流程&quot; class=&quot;headerlink&quot; title=&quot;开发流程&quot;&gt;&lt;/a&gt;开发流程&lt;/h1&gt;&lt;h2 id=&quot;声明-BLE-权限&quot;&gt;&lt;a href=&quot;#声明-BLE-权限&quot; class=&quot;headerlink&quot; title=
      
    
    </summary>
    
      <category term="Android" scheme="http://yoursite.com/categories/Android/"/>
    
      <category term="BLE" scheme="http://yoursite.com/categories/Android/BLE/"/>
    
    
      <category term="Android" scheme="http://yoursite.com/tags/Android/"/>
    
      <category term="BLE 4.0" scheme="http://yoursite.com/tags/BLE-4-0/"/>
    
  </entry>
  
  <entry>
    <title>BLE 手环开发总结</title>
    <link href="http://yoursite.com/2018/07/05/%E6%89%8B%E7%8E%AF%E5%BC%80%E5%8F%91%E6%80%BB%E7%BB%93/"/>
    <id>http://yoursite.com/2018/07/05/手环开发总结/</id>
    <published>2018-07-05T03:04:25.000Z</published>
    <updated>2018-07-05T08:21:34.713Z</updated>
    
    <content type="html"><![CDATA[<h1 id="基础功能"><a href="#基础功能" class="headerlink" title="基础功能"></a>基础功能</h1><ul><li>显示步数、距离、卡路里、电量、目标完成状况</li></ul><h1 id="功能实现过程"><a href="#功能实现过程" class="headerlink" title="功能实现过程"></a>功能实现过程</h1><ul><li><p>通过手机蓝牙与手环连接，手机 APP 发送个人设置数据给手环；当手环接收数据成功后，更新用户信息，同时返回<code>当前时刻</code>到<code>上一次同步数据时刻</code>的数据（注：数据以1小时为单位，返回的每个1小时数据是<code>每个1小时的累计数据</code>)，这次返回的数据中含有<code>掉电标志字节</code>，用于判断本次数据同步是<code>正常</code>还是<code>掉电后重新上电后的第一次同步</code>。</p></li><li><p>手机 APP 发送请求同步手环屏幕当前显示数据的数据给手环；手环接收数据成功后，返回<code>步数</code>、<code>距离</code>、<code>卡路里</code>、<code>电量</code>的数据。</p></li><li><p>手机 APP 发送请求同步手环72个小时数据的数据给手环；手环接收数据成功后，返回<code>步数</code>、<code>卡路里</code>、<code>每个小时的 UTC 秒数</code>的数据。</p></li></ul><h1 id="开发辅助"><a href="#开发辅助" class="headerlink" title="开发辅助"></a>开发辅助</h1><h2 id="数据库框架"><a href="#数据库框架" class="headerlink" title="数据库框架"></a>数据库框架</h2><p><a href="https://github.com/greenrobot/greenDAO" target="_blank" rel="noopener">greenDAO</a></p><p>简书上面的参考资料：</p><ul><li><a href="https://www.jianshu.com/p/b017ca5fe0ab" target="_blank" rel="noopener">Android Study 之 玩转GreenDao 3.2.2 点滴提升逼格~</a></li></ul><h2 id="数据库调试"><a href="#数据库调试" class="headerlink" title="数据库调试"></a>数据库调试</h2><p><a href="https://github.com/amitshekhariitbhu/Android-Debug-Database" target="_blank" rel="noopener">Android-Debug-Database</a></p><h2 id="智能刷新框架"><a href="#智能刷新框架" class="headerlink" title="智能刷新框架"></a>智能刷新框架</h2><p><a href="https://github.com/scwang90/SmartRefreshLayout" target="_blank" rel="noopener">SmartRefreshLayout</a></p><h2 id="图表显示框架"><a href="#图表显示框架" class="headerlink" title="图表显示框架"></a>图表显示框架</h2><p><a href="https://github.com/PhilJay/MPAndroidChart" target="_blank" rel="noopener">MPAndroidChart</a></p><p>CSDN 上面的两篇参考资料：</p><ul><li><a href="https://blog.csdn.net/ww897532167/article/details/77334345" target="_blank" rel="noopener">Android图表控件MPAndroidChart的简单介绍（MPAndroidChart3.0</a></li><li><a href="https://blog.csdn.net/u014136472/article/details/50273309" target="_blank" rel="noopener">MPAndroidChart 教程</a></li></ul><h2 id="Fragment-切换指示器"><a href="#Fragment-切换指示器" class="headerlink" title="Fragment 切换指示器"></a>Fragment 切换指示器</h2><p><a href="https://github.com/chenupt/SpringIndicator" target="_blank" rel="noopener">SpringIndicator</a></p><h2 id="自定义选择器框架"><a href="#自定义选择器框架" class="headerlink" title="自定义选择器框架"></a>自定义选择器框架</h2><p><a href="https://github.com/gzu-liyujiang/AndroidPicker" target="_blank" rel="noopener">AndroidPicker</a></p><h1 id="遇到的问题"><a href="#遇到的问题" class="headerlink" title="遇到的问题"></a>遇到的问题</h1><ul><li>BLE 以6.0版本为界限的开发流程、GATT 规范</li><li>Java 获取当前时间以及各种转换</li><li>ViewPager + Fragment 使用</li><li>Activity 和 Fragment 跳转、数据交互</li><li>BottomNavigationView 使用</li><li>Broadcast 使用</li><li>Service 使用</li><li>Intent 使用</li><li>异步使用</li><li>enum</li><li>自定义 View 参考：<a href="https://blog.csdn.net/ccy0122/article/details/53241648" target="_blank" rel="noopener">仿支付宝芝麻信用的仪表盘</a><br><a href="http://www.gcssloop.com/customview/CustomViewIndex/" target="_blank" rel="noopener">安卓自定义View教程</a></li><li>Fragment 的 add、hide、show。简书收藏几篇文章</li><li>由于手环储存的步数数据仅为1个小时的累计，所以当用图表显示月、年的时候，需要对数据进行处理</li><li>实时监控手机的网络、蓝牙状态变化</li><li>蓝牙、定位、位置服务权限申请</li><li>byte[] 数组对应天数开关处理</li><li>Fragment 的接口回调</li><li>自定义一个 NoScrollViewPagerAdapter</li><li>自定义一个 LogUtil</li><li>RecyclerView 使用</li><li>Bundle 使用</li></ul><h1 id="改进"><a href="#改进" class="headerlink" title="改进"></a>改进</h1><ul><li>引入 ButterKnife</li><li>使用异步加载图表数据，现在加载月、年数据比较慢</li><li>同步时间过长之后，再次同步一次会出现数据错乱情况</li><li>引入网络数据</li><li>引入 Google 的 easypermissions 作为权限获取库</li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;基础功能&quot;&gt;&lt;a href=&quot;#基础功能&quot; class=&quot;headerlink&quot; title=&quot;基础功能&quot;&gt;&lt;/a&gt;基础功能&lt;/h1&gt;&lt;ul&gt;
&lt;li&gt;显示步数、距离、卡路里、电量、目标完成状况&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&quot;功能实现过程&quot;&gt;&lt;a href
      
    
    </summary>
    
      <category term="Android" scheme="http://yoursite.com/categories/Android/"/>
    
    
      <category term="Android" scheme="http://yoursite.com/tags/Android/"/>
    
      <category term="BLE 4.0" scheme="http://yoursite.com/tags/BLE-4-0/"/>
    
  </entry>
  
  <entry>
    <title>ICON 资源网站</title>
    <link href="http://yoursite.com/2018/07/05/ICON%20%E8%B5%84%E6%BA%90%E7%BD%91%E7%AB%99/"/>
    <id>http://yoursite.com/2018/07/05/ICON 资源网站/</id>
    <published>2018-07-05T02:50:21.000Z</published>
    <updated>2018-07-05T02:59:24.522Z</updated>
    
    <content type="html"><![CDATA[<ul><li><p><a href="http://romannurik.github.io/AndroidAssetStudio/index.html" target="_blank" rel="noopener">Android Asset Studio</a></p></li><li><p><a href="https://www.materialpalette.com/icons" target="_blank" rel="noopener">Material Palette</a></p></li><li><p><a href="https://www.easyicon.net/" target="_blank" rel="noopener">easyicon</a></p></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&quot;http://romannurik.github.io/AndroidAssetStudio/index.html&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Android Asset Studio&lt;/a&gt;&lt;/p&gt;

      
    
    </summary>
    
      <category term="Android" scheme="http://yoursite.com/categories/Android/"/>
    
    
      <category term="Android" scheme="http://yoursite.com/tags/Android/"/>
    
      <category term="ICON" scheme="http://yoursite.com/tags/ICON/"/>
    
  </entry>
  
  <entry>
    <title>MPAndroidChart 翻译</title>
    <link href="http://yoursite.com/2018/07/02/MPAndroidChart%20%E7%BF%BB%E8%AF%91/"/>
    <id>http://yoursite.com/2018/07/02/MPAndroidChart 翻译/</id>
    <published>2018-07-02T04:39:10.000Z</published>
    <updated>2018-07-06T01:36:05.517Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://github.com/PhilJay/MPAndroidChart" target="_blank" rel="noopener">MPAndroidChart</a></p><h1 id="开始"><a href="#开始" class="headerlink" title="开始"></a>开始</h1><p>本章介绍使用此库的基本设置。</p><h2 id="添加依赖"><a href="#添加依赖" class="headerlink" title="添加依赖"></a>添加依赖</h2><p>作为第一步，将该库的依赖项添加到您的项目中。 如何添加依赖已经在此存储库的用法部分中进行了介绍。 推荐使用 Gradle 方式作为添加依赖的方式。</p><h2 id="创建界面"><a href="#创建界面" class="headerlink" title="创建界面"></a>创建界面</h2><p>使用 <code>LineChart</code>, <code>BarChart</code>, <code>ScatterChart</code>, <code>CandleStickChart</code>, <code>PieChart</code>, <code>BubbleChart</code> or <code>RadarChart</code> ，在 .xml 中定义：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;com.github.mikephil.charting.charts.LineChart</span><br><span class="line">        android:id=&quot;@+id/chart&quot;</span><br><span class="line">        android:layout_width=&quot;match_parent&quot;</span><br><span class="line">        android:layout_height=&quot;match_parent&quot; /&gt;</span><br></pre></td></tr></table></figure></p><p>然后从 <code>Activity</code>,  <code>Fragment</code> or <code>whatever</code> 中取回：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// in this example, a LineChart is initialized from xml</span><br><span class="line">LineChart chart = (LineChart) findViewById(R.id.chart);</span><br></pre></td></tr></table></figure></p><p>或者使用代码来创建（跟着在 layout 添加）<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">// programmatically create a LineChart</span><br><span class="line">LineChart chart = new LineChart(Context);</span><br><span class="line"></span><br><span class="line">// get a layout defined in xml</span><br><span class="line">RelativeLayout rl = (RelativeLayout) findViewById(R.id.relativeLayout);</span><br><span class="line">rl.add(chart); // add the programmatically created chart</span><br></pre></td></tr></table></figure></p><h2 id="添加数据"><a href="#添加数据" class="headerlink" title="添加数据"></a>添加数据</h2><p>在获得图表实例后，你可以创建数据并且添加到图表。这个例子使用的是 LineChart，<code>Entry</code> 类代表图表中一个点的 X，Y 坐标。其他图表类型，例如 BarChart 使用 <code>BarEntry</code>。<br>添加数据到图表，将每一个数据代入到 <code>Entry</code> 中，例如：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">YourData[] dataObjects = ...;</span><br><span class="line"></span><br><span class="line">List&lt;Entry&gt; entries = new ArrayList&lt;Entry&gt;();</span><br><span class="line"></span><br><span class="line">for (YourData data : dataObjects) &#123;</span><br><span class="line"></span><br><span class="line">    // turn your data into Entry objects</span><br><span class="line">    entries.add(new Entry(data.getValueX(), data.getValueY()));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>下一步，将 List<entry> 添加到 <code>LineDataSet</code>。DataSet 对象保存数据，同时允许单独设置数据的样式。如果启用，下面使用的“标签”仅具有描述性目的，并显示在图表中。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">LineDataSet dataSet = new LineDataSet(entries, &quot;Label&quot;); // add entries to dataset</span><br><span class="line">dataSet.setColor(...);</span><br><span class="line">dataSet.setValueTextColor(...); // styling, ...</span><br></pre></td></tr></table></figure></entry></p><p>最后一步，添加 LineDataSet 对象到 LineData 对象。这个对象持有 chart 实例的所有数据，并允许有单独样式。在你建立数据对象后，你可以使用它建立图表并刷新：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">LineData lineData = new LineData(dataSet);</span><br><span class="line">chart.setData(lineData);</span><br><span class="line">chart.invalidate(); // refresh</span><br></pre></td></tr></table></figure></p><p>请考虑到上面的仅仅是基本应用。需要更详细的扩展应用，请参考 <a href="https://github.com/PhilJay/MPAndroidChart/wiki/Setting-Data" target="_blank" rel="noopener">setting data</a> 部分，其中有很多添加数据到不同 <code>chart</code> 类型图表的例子。</p><h2 id="样式"><a href="#样式" class="headerlink" title="样式"></a>样式</h2><p>有关图表外观和数据的设置和样式的信息，请参考 <a href="https://github.com/PhilJay/MPAndroidChart/wiki/General-Chart-Settings-&amp;-Styling" target="_blank" rel="noopener">general settings &amp; styling</a> 部分。关于单个图表类型的更具体的样式和设置，请参考 <a href="https://github.com/PhilJay/MPAndroidChart/wiki/Specific-chart-settings" target="_blank" rel="noopener">specific settings &amp; styling</a>。</p><h1 id="与图表交互"><a href="#与图表交互" class="headerlink" title="与图表交互"></a>与图表交互</h1><p>该库允许您完全自定义与图表视图的可能触摸（和手势）交互，并通过回调方法对交互作出反应。</p><h2 id="启用-禁用交互"><a href="#启用-禁用交互" class="headerlink" title="启用/禁用交互"></a>启用/禁用交互</h2><ul><li><code>setTouchEnabled(boolean enabled)</code> 允许启用/禁用与图表的所有可能的触摸交互。</li><li><code>setDragEnabled(boolean enabled)</code> 启用/禁用图表的拖动（平移）。</li><li><code>setScaleEnabled(boolean enabled)</code> 启用/禁用两个轴上的图表缩放。</li><li><code>setScaleXEnabled(boolean enabled)</code> 启用/禁用 X 轴缩放。</li><li><code>setScaleYEnabled(boolean enabled)</code> 启用/禁用 Y 轴缩放。</li><li><code>setPinchZoom(boolean enabled)</code> 如果设置为 <code>true</code>，则启用缩放。如果禁用，则可以单独缩放 X 轴和 Y 轴。</li><li><code>setDoubleTapToZoomEnabled(boolean enabled)</code> 将此设置为 <code>false</code> 以禁止通过双击来缩放图表。</li></ul><h2 id="图表抛物线-减速"><a href="#图表抛物线-减速" class="headerlink" title="图表抛物线/减速"></a>图表抛物线/减速</h2><ul><li><code>setDragDecelerationEnabled(boolean enabled)</code> 如果设置为 <code>true</code>，则图表会在触摸后继续滚动。 默认值：<code>true</code>。</li><li><code>setDragDecelerationFrictionCoef(float coef)</code> 减速摩擦系数在 <code>[0; 1]</code> 之间，较高的值表示<code>速度将缓慢下降</code>，例如，如果设置为 <code>0</code>，它将立即停止。 <code>1</code> 是无效值，将自动转换为 <code>0.9999</code>。</li></ul><h2 id="突出显示值"><a href="#突出显示值" class="headerlink" title="突出显示值"></a>突出显示值</h2><p>如何允许通过点击手势和编程方式，突出显示条目在 <a href="https://github.com/PhilJay/MPAndroidChart/wiki/Highlighting" target="_blank" rel="noopener">highlightning section</a> 中进行了描述。</p><h2 id="手势回调"><a href="#手势回调" class="headerlink" title="手势回调"></a>手势回调</h2><p><code>OnChartGestureListener</code> 将允许您对图表上的手势做出反应：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line">public interface OnChartGestureListener &#123;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * Callbacks when a touch-gesture has started on the chart (ACTION_DOWN)</span><br><span class="line">     *</span><br><span class="line">     * @param me</span><br><span class="line">     * @param lastPerformedGesture</span><br><span class="line">     */</span><br><span class="line">    void onChartGestureStart(MotionEvent me, ChartTouchListener.ChartGesture lastPerformedGesture);</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * Callbacks when a touch-gesture has ended on the chart (ACTION_UP, ACTION_CANCEL)</span><br><span class="line">     *</span><br><span class="line">     * @param me</span><br><span class="line">     * @param lastPerformedGesture</span><br><span class="line">     */</span><br><span class="line">    void onChartGestureEnd(MotionEvent me, ChartTouchListener.ChartGesture lastPerformedGesture);</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * Callbacks when the chart is longpressed.</span><br><span class="line">     *</span><br><span class="line">     * @param me</span><br><span class="line">     */</span><br><span class="line">    public void onChartLongPressed(MotionEvent me);</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * Callbacks when the chart is double-tapped.</span><br><span class="line">     *</span><br><span class="line">     * @param me</span><br><span class="line">     */</span><br><span class="line">    public void onChartDoubleTapped(MotionEvent me);</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * Callbacks when the chart is single-tapped.</span><br><span class="line">     *</span><br><span class="line">     * @param me</span><br><span class="line">     */</span><br><span class="line">    public void onChartSingleTapped(MotionEvent me);</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * Callbacks then a fling gesture is made on the chart.</span><br><span class="line">     *</span><br><span class="line">     * @param me1</span><br><span class="line">     * @param me2</span><br><span class="line">     * @param velocityX</span><br><span class="line">     * @param velocityY</span><br><span class="line">     */</span><br><span class="line">    public void onChartFling(MotionEvent me1, MotionEvent me2, float velocityX, float velocityY);</span><br><span class="line"></span><br><span class="line">   /**</span><br><span class="line">     * Callbacks when the chart is scaled / zoomed via pinch zoom gesture.</span><br><span class="line">     *</span><br><span class="line">     * @param me</span><br><span class="line">     * @param scaleX scalefactor on the x-axis</span><br><span class="line">     * @param scaleY scalefactor on the y-axis</span><br><span class="line">     */</span><br><span class="line">    public void onChartScale(MotionEvent me, float scaleX, float scaleY);</span><br><span class="line"></span><br><span class="line">   /**</span><br><span class="line">    * Callbacks when the chart is moved / translated via drag gesture.</span><br><span class="line">    *</span><br><span class="line">    * @param me</span><br><span class="line">    * @param dX translation distance on the x-axis</span><br><span class="line">    * @param dY translation distance on the y-axis</span><br><span class="line">    */</span><br><span class="line">    public void onChartTranslate(MotionEvent me, float dX, float dY);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>只需让你接收回调的类实现这个接口，并将其设置为图表的监听器：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chart.setOnChartGestureListener(this);</span><br></pre></td></tr></table></figure></p><h1 id="高亮显示值"><a href="#高亮显示值" class="headerlink" title="高亮显示值"></a>高亮显示值</h1><p>本节重点介绍通过 <code>tap-gesture</code> 和基于发行版 v3.0.0 以编程方式，高亮显示图表中条目的主题。</p><h2 id="启用-禁用高亮显示"><a href="#启用-禁用高亮显示" class="headerlink" title="启用/禁用高亮显示"></a>启用/禁用高亮显示</h2><ul><li><code>setHighlightPerDragEnabled(boolean enabled)</code> 在图表上将此设置为 <code>true</code>，以便在完全缩小时，在图表表面上进行每次<code>拖动</code>时高亮显示。 默认值： <code>true</code></li><li><code>setHighlightPerTapEnabled(boolean enabled)</code> 在图表上将此设置为 <code>false</code>，以防止通过<code>点击手势</code>高亮显示值。 但仍可通过拖动或以编程方式高亮显示值。 默认值： <code>true</code></li><li><code>setMaxHighlightDistance(float distanceDp)</code> 在 <code>dp</code> 中设置最大的高光距离。在图表上轻敲远离条目的距离，不会触发高亮显示。 默认值： <code>500dp</code></li></ul><p>除此之外，还可以为各个 <code>DataSet</code> 对象配置高亮显示：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">dataSet.setHighlightEnabled(true); // allow highlighting for DataSet</span><br><span class="line"></span><br><span class="line"> // set this to false to disable the drawing of highlight indicator (lines)</span><br><span class="line"> dataSet.setDrawHighlightIndicators(true);</span><br><span class="line"> dataSet.setHighlightColor(Color.BLACK); // color for highlight indicator</span><br><span class="line"> // and more...</span><br></pre></td></tr></table></figure></p><h2 id="以编程方式突出显示"><a href="#以编程方式突出显示" class="headerlink" title="以编程方式突出显示"></a>以编程方式突出显示</h2><ul><li><code>highlightValue(float x, int dataSetIndex, boolean callListener)</code> 高亮显示给定 <code>DataSet</code> 中给定 <code>x</code>位置的值。 提供 <code>-1</code> 作为 <code>dataSetIndex</code> 以撤消所有高亮显示。<code>布尔标志</code>确定是否应该调用选择侦听器。</li><li><code>highlightValue(Highlight high, boolean callListener)</code> 高亮显示提供的 <code>Highlight对象</code> 所代表的值。提供 <code>null</code> 以撤消所有高亮显示。<code>布尔标志</code>确定是否应该调用选择侦听器。</li><li><code>highlightValues(Highlight[] highs)</code> 高亮显示给定 <code>Highlight []</code> 数组所表示的值。提供 <code>null</code> 或<code>空数组</code>以撤消所有高亮显示。</li><li><p><code>getHighlighted()</code> 返回 <code>Highlight []</code> 数组，其中包含有关所有高亮显示的条目，<code>x-index</code> 和 <code>dataset-index</code> 的信息。</p><h2 id="选择回调"><a href="#选择回调" class="headerlink" title="选择回调"></a>选择回调</h2><p>该库在交互时为回调提供了许多侦听器。 其中一个是 <code>OnChartValueSelectedListener</code>，用于通过触控高亮显示值时的回调：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"> public interface OnChartValueSelectedListener &#123;</span><br><span class="line">    /**</span><br><span class="line">    * Called when a value has been selected inside the chart.</span><br><span class="line">    *</span><br><span class="line">    * @param e The selected Entry.</span><br><span class="line">    * @param h The corresponding highlight object that contains information</span><br><span class="line">    * about the highlighted position</span><br><span class="line">    */</span><br><span class="line">    public void onValueSelected(Entry e, Highlight h);</span><br><span class="line">    /**</span><br><span class="line">    * Called when nothing has been selected or an &quot;un-select&quot; has been made.</span><br><span class="line">    */</span><br><span class="line">    public void onNothingSelected();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><p>只需让你的接收回调的类，实现这个接口并将其设置为图表的监听器：<br><code>chart.setOnChartValueSelectedListener(this);</code></p><h2 id="高亮的类"><a href="#高亮的类" class="headerlink" title="高亮的类"></a>高亮的类</h2><p><code>Highlight类</code> 表示与高亮显示的 <code>Entry</code> 关联的所有数据，例如高亮显示的 <code>Entry对象</code> 本身，它所属的 <code>DataSet</code>，它在绘图表面上的位置等等。它可用于获取有关已高亮显示的条目的信息，或用于向图表提供要高亮显示的条目的信息。关于这个目的，<code>Highlight类</code> 提供了两个构造函数：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">/** constructor for standard highlight */</span><br><span class="line">public Highlight(float x, int dataSetIndex) &#123; ... &#125;</span><br><span class="line"></span><br><span class="line">/** constructor for stacked BarEntry highlight */</span><br><span class="line">public Highlight(float x, int dataSetIndex, int stackIndex) &#123; ... &#125;</span><br></pre></td></tr></table></figure></p><p>这些构造函数可用于创建 <code>Highlight对象</code>，该对象允许以编程方式执行突出显示：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">// highlight the entry and x-position 50 in the first (0) DataSet</span><br><span class="line">Highlight highlight = new Highlight(50f, 0);</span><br><span class="line"></span><br><span class="line">chart.highlightValue(highlight, false); // highlight this value, don&apos;t call listener</span><br></pre></td></tr></table></figure></p><h2 id="自定义高亮"><a href="#自定义高亮" class="headerlink" title="自定义高亮"></a>自定义高亮</h2><p>所有用户输入的高亮手势形式，都由默认的 <code>ChartHighlighter类</code> 在内部处理。使用以下方法，用自定义实现替换默认的 <code>highligher</code>：</p><ul><li><code>setHighlighter（ChartHighlighter highlighter）</code> 为图表设置自定义 <code>highligher对象</code>，以处理在图表视图上执行的所有高亮触摸事件。您自定义的 <code>highlighter对象</code> 需要继承 <code>ChartHighlighter类</code>。</li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;a href=&quot;https://github.com/PhilJay/MPAndroidChart&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;MPAndroidChart&lt;/a&gt;&lt;/p&gt;
&lt;h1 id=&quot;开始&quot;&gt;&lt;a href=&quot;#开始&quot; class
      
    
    </summary>
    
      <category term="Android" scheme="http://yoursite.com/categories/Android/"/>
    
      <category term="Chart" scheme="http://yoursite.com/categories/Android/Chart/"/>
    
    
      <category term="Android" scheme="http://yoursite.com/tags/Android/"/>
    
      <category term="Chart" scheme="http://yoursite.com/tags/Chart/"/>
    
      <category term="翻译" scheme="http://yoursite.com/tags/%E7%BF%BB%E8%AF%91/"/>
    
  </entry>
  
  <entry>
    <title>JSON 数据解析</title>
    <link href="http://yoursite.com/2018/06/26/JSON%20%E6%95%B0%E6%8D%AE%E8%A7%A3%E6%9E%90/"/>
    <id>http://yoursite.com/2018/06/26/JSON 数据解析/</id>
    <published>2018-06-25T18:21:16.000Z</published>
    <updated>2018-07-06T01:36:36.074Z</updated>
    
    <content type="html"><![CDATA[<h2 id="JSONObject-及-JSONArray-取值"><a href="#JSONObject-及-JSONArray-取值" class="headerlink" title="JSONObject 及 JSONArray 取值"></a>JSONObject 及 JSONArray 取值</h2><h3 id="String-转-JSONObject-或-JSONArray"><a href="#String-转-JSONObject-或-JSONArray" class="headerlink" title="String 转 JSONObject 或 JSONArray"></a>String 转 JSONObject 或 JSONArray</h3><pre><code>JSONArray jsonArray = JSONArray.fromObject(str);JSONObject jsonObject = JSONObject.fromObject(str);</code></pre><h3 id="JSONObject-中获取-JSONArray-或-String"><a href="#JSONObject-中获取-JSONArray-或-String" class="headerlink" title="JSONObject 中获取 JSONArray 或 String"></a>JSONObject 中获取 JSONArray 或 String</h3><pre><code>JSONObject jsonObject = new JSONObject(resource);String str = jsonObject.getString(&quot;str&quot;);//获取 sequences的值JSONArray sequencesArray = jsonObject.getJSONArray(&quot;sequences&quot;);</code></pre><p>JSONObject 中还有其它 get 方法。</p><h3 id="JSONArray-中获取-JSONObject-或-String"><a href="#JSONArray-中获取-JSONObject-或-String" class="headerlink" title="JSONArray 中获取 JSONObject 或 String"></a>JSONArray 中获取 JSONObject 或 String</h3><pre><code>JSONArray jsonArray = new JSONArray(resource);String str = jsonArray.getString(0);JSONObject jsonObject = jsonArray.getJSONObject(0);</code></pre><p>解析 json 格式的数据时要看清楚，最外面为 <code>{</code> 的是 JSONObject ，为 <code>[</code> 的是JSONArray。</p><h3 id="实例"><a href="#实例" class="headerlink" title="实例"></a>实例</h3><h4 id="JSONArray-中获取-JSONObject"><a href="#JSONArray-中获取-JSONObject" class="headerlink" title="JSONArray 中获取 JSONObject"></a>JSONArray 中获取 JSONObject</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">public class Province extends DataSupport &#123;</span><br><span class="line"></span><br><span class="line">    private int id;</span><br><span class="line"></span><br><span class="line">    private String provinceName;</span><br><span class="line"></span><br><span class="line">    private int provinceCode;</span><br><span class="line"></span><br><span class="line">    public int getId() &#123;</span><br><span class="line">        return id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setId(int id) &#123;</span><br><span class="line">        this.id = id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public String getProvinceName() &#123;</span><br><span class="line">        return provinceName;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setProvinceName(String provinceName) &#123;</span><br><span class="line">        this.provinceName = provinceName;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public int getProvinceCode() &#123;</span><br><span class="line">        return provinceCode;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setProvinceCode(int provinceCode) &#123;</span><br><span class="line">        this.provinceCode = provinceCode;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">JSON 数组 [&#123;&quot;id&quot;:1, &quot;name&quot;:北京&#125;,&#123;&quot;id&quot;:2, &quot;name&quot;:上海&#125;,&#123;&quot;id&quot;:3, &quot;name&quot;:天津&#125;,&#123;&quot;id&quot;:4, &quot;name&quot;:重庆&#125;,&#123;&quot;id&quot;:5, &quot;name&quot;:香港&#125;]</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">public static boolean handleProvinceResponse(String response) &#123;</span><br><span class="line">        if (!TextUtils.isEmpty(response)) &#123;</span><br><span class="line">            try &#123;</span><br><span class="line">                JSONArray allProvinces = new JSONArray(response);</span><br><span class="line">                for (int i = 0; i &lt; allProvinces.length(); i++) &#123;</span><br><span class="line">                    JSONObject provinceObject = allProvinces.getJSONObject(i);</span><br><span class="line">                    Province province = new Province();</span><br><span class="line">                    province.setProvinceName(provinceObject.getString(&quot;name&quot;));</span><br><span class="line">                    province.setProvinceCode(provinceObject.getInt(&quot;id&quot;));</span><br><span class="line">                    province.save();</span><br><span class="line">                &#125;</span><br><span class="line">                return true;</span><br><span class="line">            &#125; catch (JSONException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        return false;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h4 id="JSONObject-中获取-JSONArray，然后在从-JSONArray-中获取-JSONObject"><a href="#JSONObject-中获取-JSONArray，然后在从-JSONArray-中获取-JSONObject" class="headerlink" title="JSONObject 中获取 JSONArray，然后在从 JSONArray 中获取 JSONObject"></a>JSONObject 中获取 JSONArray，然后在从 JSONArray 中获取 JSONObject</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">public class Weather &#123;</span><br><span class="line"></span><br><span class="line">    public String status;</span><br><span class="line"></span><br><span class="line">    public Basic basic;</span><br><span class="line"></span><br><span class="line">    public AQI aqi;</span><br><span class="line"></span><br><span class="line">    public Now now;</span><br><span class="line"></span><br><span class="line">    public Suggestion suggestion;</span><br><span class="line"></span><br><span class="line">    @SerializedName(&quot;daily_forecast&quot;)</span><br><span class="line">    public List&lt;Forecast&gt; forecastList;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;HeWeather&quot;: [&#123;&quot;basic&quot;:&#123;&quot;cid&quot;:&quot;CN101300105&quot;,&quot;location&quot;:&quot;隆安&quot;,&quot;parent_city&quot;:&quot;南宁&quot;,&quot;admin_area&quot;:&quot;广西&quot;,&quot;cnty&quot;:&quot;中国&quot;,&quot;lat&quot;:&quot;23.17476273&quot;,&quot;lon&quot;:&quot;107.68865967&quot;,&quot;tz&quot;:&quot;+8.00&quot;,&quot;city&quot;:&quot;隆安&quot;,&quot;id&quot;:&quot;CN101300105&quot;,&quot;update&quot;:&#123;&quot;loc&quot;:&quot;2018-05-02 11:47&quot;,&quot;utc&quot;:&quot;2018-05-02 03:47&quot;&#125;&#125;,&quot;update&quot;:&#123;&quot;loc&quot;:&quot;2018-05-02 11:47&quot;,&quot;utc&quot;:&quot;2018-05-02 03:47&quot;&#125;,&quot;status&quot;:&quot;ok&quot;,&quot;now&quot;:&#123;&quot;cloud&quot;:&quot;25&quot;,&quot;cond_code&quot;:&quot;300&quot;,&quot;cond_txt&quot;:&quot;阵雨&quot;,&quot;fl&quot;:&quot;32&quot;,&quot;hum&quot;:&quot;71&quot;,&quot;pcpn&quot;:&quot;0.0&quot;,&quot;pres&quot;:&quot;1014&quot;,&quot;tmp&quot;:&quot;29&quot;,&quot;vis&quot;:&quot;10&quot;,&quot;wind_deg&quot;:&quot;107&quot;,&quot;wind_dir&quot;:&quot;东南风&quot;,&quot;wind_sc&quot;:&quot;1&quot;,&quot;wind_spd&quot;:&quot;4&quot;,&quot;cond&quot;:&#123;&quot;code&quot;:&quot;300&quot;,&quot;txt&quot;:&quot;阵雨&quot;&#125;&#125;,&quot;daily_forecast&quot;:[&#123;&quot;date&quot;:&quot;2018-05-02&quot;,&quot;cond&quot;:&#123;&quot;txt_d&quot;:&quot;中雨&quot;&#125;,&quot;tmp&quot;:&#123;&quot;max&quot;:&quot;30&quot;,&quot;min&quot;:&quot;23&quot;&#125;&#125;,&#123;&quot;date&quot;:&quot;2018-05-03&quot;,&quot;cond&quot;:&#123;&quot;txt_d&quot;:&quot;阵雨&quot;&#125;,&quot;tmp&quot;:&#123;&quot;max&quot;:&quot;27&quot;,&quot;min&quot;:&quot;22&quot;&#125;&#125;,&#123;&quot;date&quot;:&quot;2018-05-04&quot;,&quot;cond&quot;:&#123;&quot;txt_d&quot;:&quot;阵雨&quot;&#125;,&quot;tmp&quot;:&#123;&quot;max&quot;:&quot;28&quot;,&quot;min&quot;:&quot;23&quot;&#125;&#125;],&quot;hourly&quot;:[&#123;&quot;cloud&quot;:&quot;90&quot;,&quot;cond_code&quot;:&quot;305&quot;,&quot;cond_txt&quot;:&quot;小雨&quot;,&quot;dew&quot;:&quot;26&quot;,&quot;hum&quot;:&quot;83&quot;,&quot;pop&quot;:&quot;58&quot;,&quot;pres&quot;:&quot;1012&quot;,&quot;time&quot;:&quot;2018-05-02 13:00&quot;,&quot;tmp&quot;:&quot;30&quot;,&quot;wind_deg&quot;:&quot;188&quot;,&quot;wind_dir&quot;:&quot;南风&quot;,&quot;wind_sc&quot;:&quot;1-2&quot;,&quot;wind_spd&quot;:&quot;11&quot;&#125;,&#123;&quot;cloud&quot;:&quot;95&quot;,&quot;cond_code&quot;:&quot;305&quot;,&quot;cond_txt&quot;:&quot;小雨&quot;,&quot;dew&quot;:&quot;24&quot;,&quot;hum&quot;:&quot;85&quot;,&quot;pop&quot;:&quot;49&quot;,&quot;pres&quot;:&quot;1010&quot;,&quot;time&quot;:&quot;2018-05-02 16:00&quot;,&quot;tmp&quot;:&quot;30&quot;,&quot;wind_deg&quot;:&quot;172&quot;,&quot;wind_dir&quot;:&quot;南风&quot;,&quot;wind_sc&quot;:&quot;1-2&quot;,&quot;wind_spd&quot;:&quot;1&quot;&#125;,&#123;&quot;cloud&quot;:&quot;98&quot;,&quot;cond_code&quot;:&quot;305&quot;,&quot;cond_txt&quot;:&quot;小雨&quot;,&quot;dew&quot;:&quot;24&quot;,&quot;hum&quot;:&quot;87&quot;,&quot;pop&quot;:&quot;25&quot;,&quot;pres&quot;:&quot;1010&quot;,&quot;time&quot;:&quot;2018-05-02 19:00&quot;,&quot;tmp&quot;:&quot;29&quot;,&quot;wind_deg&quot;:&quot;173&quot;,&quot;wind_dir&quot;:&quot;南风&quot;,&quot;wind_sc&quot;:&quot;1-2&quot;,&quot;wind_spd&quot;:&quot;8&quot;&#125;,&#123;&quot;cloud&quot;:&quot;99&quot;,&quot;cond_code&quot;:&quot;305&quot;,&quot;cond_txt&quot;:&quot;小雨&quot;,&quot;dew&quot;:&quot;23&quot;,&quot;hum&quot;:&quot;89&quot;,&quot;pop&quot;:&quot;20&quot;,&quot;pres&quot;:&quot;1013&quot;,&quot;time&quot;:&quot;2018-05-02 22:00&quot;,&quot;tmp&quot;:&quot;28&quot;,&quot;wind_deg&quot;:&quot;27&quot;,&quot;wind_dir&quot;:&quot;东北风&quot;,&quot;wind_sc&quot;:&quot;1-2&quot;,&quot;wind_spd&quot;:&quot;9&quot;&#125;,&#123;&quot;cloud&quot;:&quot;99&quot;,&quot;cond_code&quot;:&quot;104&quot;,&quot;cond_txt&quot;:&quot;阴&quot;,&quot;dew&quot;:&quot;22&quot;,&quot;hum&quot;:&quot;90&quot;,&quot;pop&quot;:&quot;71&quot;,&quot;pres&quot;:&quot;1012&quot;,&quot;time&quot;:&quot;2018-05-03 01:00&quot;,&quot;tmp&quot;:&quot;25&quot;,&quot;wind_deg&quot;:&quot;5&quot;,&quot;wind_dir&quot;:&quot;北风&quot;,&quot;wind_sc&quot;:&quot;1-2&quot;,&quot;wind_spd&quot;:&quot;6&quot;&#125;,&#123;&quot;cloud&quot;:&quot;100&quot;,&quot;cond_code&quot;:&quot;306&quot;,&quot;cond_txt&quot;:&quot;中雨&quot;,&quot;dew&quot;:&quot;22&quot;,&quot;hum&quot;:&quot;93&quot;,&quot;pop&quot;:&quot;49&quot;,&quot;pres&quot;:&quot;1012&quot;,&quot;time&quot;:&quot;2018-05-03 04:00&quot;,&quot;tmp&quot;:&quot;24&quot;,&quot;wind_deg&quot;:&quot;2&quot;,&quot;wind_dir&quot;:&quot;北风&quot;,&quot;wind_sc&quot;:&quot;1-2&quot;,&quot;wind_spd&quot;:&quot;6&quot;&#125;,&#123;&quot;cloud&quot;:&quot;100&quot;,&quot;cond_code&quot;:&quot;104&quot;,&quot;cond_txt&quot;:&quot;阴&quot;,&quot;dew&quot;:&quot;22&quot;,&quot;hum&quot;:&quot;93&quot;,&quot;pop&quot;:&quot;34&quot;,&quot;pres&quot;:&quot;1013&quot;,&quot;time&quot;:&quot;2018-05-03 07:00&quot;,&quot;tmp&quot;:&quot;23&quot;,&quot;wind_deg&quot;:&quot;11&quot;,&quot;wind_dir&quot;:&quot;北风&quot;,&quot;wind_sc&quot;:&quot;1-2&quot;,&quot;wind_spd&quot;:&quot;10&quot;&#125;,&#123;&quot;cloud&quot;:&quot;100&quot;,&quot;cond_code&quot;:&quot;305&quot;,&quot;cond_txt&quot;:&quot;小雨&quot;,&quot;dew&quot;:&quot;22&quot;,&quot;hum&quot;:&quot;86&quot;,&quot;pop&quot;:&quot;70&quot;,&quot;pres&quot;:&quot;1015&quot;,&quot;time&quot;:&quot;2018-05-03 10:00&quot;,&quot;tmp&quot;:&quot;23&quot;,&quot;wind_deg&quot;:&quot;3&quot;,&quot;wind_dir&quot;:&quot;北风&quot;,&quot;wind_sc&quot;:&quot;1-2&quot;,&quot;wind_spd&quot;:&quot;2&quot;&#125;],&quot;aqi&quot;:&#123;&quot;city&quot;:&#123;&quot;aqi&quot;:&quot;51&quot;,&quot;pm25&quot;:&quot;29&quot;,&quot;qlty&quot;:&quot;良&quot;&#125;&#125;,&quot;suggestion&quot;:&#123;&quot;comf&quot;:&#123;&quot;type&quot;:&quot;comf&quot;,&quot;brf&quot;:&quot;较舒适&quot;,&quot;txt&quot;:&quot;白天有雨，从而使空气湿度加大，会使人们感觉有点儿闷热，但早晚的天气很凉爽、舒适。&quot;&#125;,&quot;sport&quot;:&#123;&quot;type&quot;:&quot;sport&quot;,&quot;brf&quot;:&quot;较不宜&quot;,&quot;txt&quot;:&quot;有较强降水，建议您选择在室内进行健身休闲运动。&quot;&#125;,&quot;cw&quot;:&#123;&quot;type&quot;:&quot;cw&quot;,&quot;brf&quot;:&quot;不宜&quot;,&quot;txt&quot;:&quot;不宜洗车，未来24小时内有雨，如果在此期间洗车，雨水和路上的泥水可能会再次弄脏您的爱车。&quot;&#125;&#125;&#125;]&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * 将返回的 JSON 数据解析成 Weather 实体类</span><br><span class="line"> */</span><br><span class="line">public static Weather parseWeatherResponse(String response) &#123;</span><br><span class="line">    try &#123;</span><br><span class="line"></span><br><span class="line">        JSONObject jsonObject = new JSONObject(response);</span><br><span class="line">        JSONArray jsonArray = jsonObject.getJSONArray(&quot;HeWeather&quot;);</span><br><span class="line">        String weatherContent = jsonArray.getJSONObject(0).toString();</span><br><span class="line"></span><br><span class="line">        return new Gson().fromJson(weatherContent, Weather.class);</span><br><span class="line">    &#125; catch (Exception e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">    return null;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;JSONObject-及-JSONArray-取值&quot;&gt;&lt;a href=&quot;#JSONObject-及-JSONArray-取值&quot; class=&quot;headerlink&quot; title=&quot;JSONObject 及 JSONArray 取值&quot;&gt;&lt;/a&gt;JSONObject 
      
    
    </summary>
    
      <category term="Android" scheme="http://yoursite.com/categories/Android/"/>
    
    
      <category term="Android" scheme="http://yoursite.com/tags/Android/"/>
    
      <category term="JSON" scheme="http://yoursite.com/tags/JSON/"/>
    
  </entry>
  
</feed>
